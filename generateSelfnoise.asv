function [y_r ]=generateSelfnoise(lenT,Fsout)
load selfnoise Fs Y powerspec SIGMA X MU Y winN f
I=1:length(powerspec(1,:));
X=(powerspec(:,I));
SIGMA = cov(X);
MU=mean(X);
Y = mvnrnd(MU,SIGMA,1);
B = fir2(winN,f/(Fs/2),10.^(Y'/20));
y=filter(B,1,randn(lenT*Fs,1));
y_r=resample(y,Fsout,Fs);

